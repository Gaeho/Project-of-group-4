<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SrComMypageDao">

	<select id="SrComTotal" resultType="int">
		select count(*)
		from company
	</select>
	
	<select id="SrComInfo" resultType="CommCompany">
		select company.com_id, company.com_name, company.com_addr, company.com_web, company.com_regnum, company.com_email, 
		company.com_mgr_tel, company.com_tel, company.com_bus, company.com_logo, comm.*
		from company, comm
		where company.com_sec=comm.sub_cat
		and company.com_id='znvkd323'
		and comm.main_cat='050'
	</select>
	
	<select id="SrComAnnReg" parameterType="Announce" resultType="Announce">
	<![CDATA[
		select *
		from 
    		(
    		 select rownum rn, z.*
    		 from ( 
    		 		select * 
			 		from announce
			 		where ANNO_C_REGDATE > sysdate
			 		and com_id = 'tlstprp5184'
			 	   ) z
    		 )
		where rn between #{start} and #{end}
		]]>
	</select>
	
	<select id="SrComAnnCReg" parameterType="Announce" resultType="Announce">
		<![CDATA[
		select *
		from 
    		(
    		 select rownum rn, z.*
    		 from ( 
    		 		select * 
			 		from announce
			 		where ANNO_C_REGDATE < sysdate
			 		and com_id = 'tlstprp5184'
			       ) z
    		 )
		where rn between #{start} and #{end}    		 
		]]>
	</select>
	
	<select id="SrAppAnnMemReg" parameterType="AppAnnMem" resultType="AppAnnMem">
		<![CDATA[
		select *
		from 
		    (
		     select rownum rn, z.*
		     from ( 
		     		select m.user_id, m.user_img, a.app_regdate, an.anno_c_regdate, an.anno_regdate, an.anno_code
		            from member m, apply a, announce an
		            where m.user_id = a.user_id
		            and a.anno_code = an.anno_code 
		            and an.com_id = 'tlstprp5184'
		            and ANNO_C_REGDATE > sysdate 
		           ) z
		    )
		where rn between #{start} and #{end} 
		]]>
	</select>
	
	<select id="SrAppAnnMemCReg" parameterType="AppAnnMem" resultType="AppAnnMem">
		<![CDATA[
		select *
		from 
		    (
		     select rownum rn, z.*
		     from (
		            select m.user_id, m.user_img, a.app_regdate, an.anno_c_regdate, an.anno_regdate, an.anno_code
		            from member m, apply a, announce an
		            where m.user_id = a.user_id
		            and a.anno_code = an.anno_code 
		            and an.com_id = 'tlstprp5184'
		            and ANNO_C_REGDATE < sysdate
		           ) z
		     )
		where rn between #{start} and #{end} 
		]]>
	</select>
	
	<select id="SrCommMemResumeList" parameterType="CommMemResume" resultType="CommMemResume">
		select comm.*, mem.*, res.res_tag1, res.res_tag2, res.res_tag3
	from member mem, resume res, comm
	where mem.user_id=res.user_id
	and comm.sub_cat=mem.user_edu
	</select>
	
	<select id="SrBmarkList" parameterType="MemBmark" resultType="MemBmark">
		select *
		from 
    		( select rownum rn, a.*
    		  from (select b.com_id, m.user_img, b.user_id, b.mrk_date
                    from member m, bookmark b
                    where m.user_id = b.user_id
                    and b.com_id = 'tlstprp5184') a
    		        )
		where rn between #{start} and #{end} 
	</select>
	
	<select id="SrUserDetail" parameterType="String" resultType="Member">
		select *
		from member 
		where user_id = #{user_id}
	</select>
	
	<select id="SrJobTag" parameterType="Member" resultType="Comm">
		select distinct c.comm_ctx
		from member m
		inner join comm c
		on m.user_job_tag = c.sub_cat
		where main_cat = 001
		and m.user_job_tag = #{user_job_tag}
	</select>
	
	<select id="SrGetInfo" parameterType="MemBmark" resultType="int">
		select count(*)
		from bookmark 
		where com_id = #{com_id}
		and user_id = #{user_id}
	</select>
	
	<insert id="SrBmplus" parameterType="Bookmark">
		insert into bookmark 
		values (#{com_id},#{user_id},1,sysdate);
	</insert>
	
	<update id="SrBmcancle" parameterType="Bookmark">
		update bookmark set <include refid="cal"></include>
		where com_id = #{com_id} 
		and user_id = #{user_id}
	</update>
	
	<sql id="cal">
		<if test="count == 1">
			it_bookmark = 0
		</if>
	
		<if test="count == 0">
			it_bookmark = it_bookmark + 1
		</if>
	</sql>
	
	<select id="SrBmarkResume" parameterType="String" resultType="CommMemResume">
		select * from resume
		where user_id = #{user_id}
		and rep_res = '1'
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</mapper>